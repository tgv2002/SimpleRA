LOAD EMPLOYEE
LOAD WORKS_ON
LOAD PROJECT

S1 <- SELECT Salary >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn, Salary FROM S1

S21 <- PROJECT Ssn, Bdate, Salary, Super_ssn FROM EMPLOYEE
S22 <- PROJECT Ssn, Bdate FROM EMPLOYEE
M21 <- CROSS S21 S22
M22 <- SELECT Super_ssn == S22_Ssn FROM M21
M23 <- SELECT S21_Bdate == S22_Bdate FROM M22
Q2 <- PROJECT S21_Ssn, Super_ssn, S21_Bdate FROM M23
RENAME S21_Ssn TO Ssn FROM Q2
RENAME S21_Bdate TO Bdate FROM Q2

S31 <- PROJECT Ssn, Sex FROM EMPLOYEE
S32 <- PROJECT Essn, Pno FROM WORKS_ON
M31 <- CROSS S31 S32
M32 <- SELECT Ssn == Essn FROM M31
MALE <- SELECT Sex == 0 FROM M32
MALE_PNO <- PROJECT Pno FROM MALE
FEMALE <- SELECT Sex == 1 FROM M32
FEMALE_PNO <- PROJECT Pno FROM FEMALE
CROSS_PNO <- CROSS MALE_PNO FEMALE_PNO
BOTH_PNO <- SELECT MALE_PNO_Pno == FEMALE_PNO_Pno FROM CROSS_PNO
RENAME MALE_PNO_Pno TO Pno FROM BOTH_PNO
Q3 <- PROJECT Pno FROM BOTH_PNO

EMP_SUPER <- PROJECT Ssn, Super_ssn FROM EMPLOYEE
EMP_PNO <- PROJECT Essn, Pno FROM WORKS_ON
C <- CROSS EMP_SUPER EMP_PNO
JOIN1 <- SELECT Ssn == Essn FROM C
C2 <- CROSS JOIN1 EMP_PNO
JOIN2 <- SELECT Super_ssn == EMP_PNO_Essn FROM C2
RENAME JOIN1_Pno TO Pno FROM JOIN2
RENAME EMP_PNO_Pno TO Super_Pno FROM JOIN2
ANS <- SELECT Pno == Super_Pno FROM JOIN2
Q4 <- PROJECT Ssn, Super_ssn, Pno FROM ANS

A1 <- SELECT Dnum <= 5 FROM PROJECT
A2 <- SELECT Dnum >= 1 FROM A1
A3 <- SELECT Dnum != 2 FROM A2
A4 <- SELECT Dnum != 3 FROM A3
Q5 <- SELECT Dnum != 4 FROM A4

EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
EXPORT Q5
QUIT
